<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Vartotojų sąrašas</title>
    <link rel="stylesheet" href="style.css" />
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>

  <div class="header">
    <div class="header-top">
      <a href="#default" class="logo">Logo</a>
      <a href="javascript:void(0);" class="icon" onclick="toggleMenu()">&#9776;</a>
    </div>

    <div class="header-right" id="navLinks">
      <a class="active" href="#home">Home</a>
      <a href="#news">News</a>
      <a href="#contact">Contact</a>
    </div>
  </div>

  <div class="container">
      <h1>Dalyvių registracija</h1>

      <form id="add-user-form">
          <input type="text" id="vardas" placeholder="Vardas" required />
          <input type="text" id="pavarde" placeholder="Pavardė" required />
          <input type="number" id="kubatura" placeholder="Kubatura" required />
          <button type="submit">Pridėti vartotoją</button>
      </form>

      <ul id="user-list"></ul>
  </div>

  <script>
  function toggleMenu() {
      document.getElementById("navLinks").classList.toggle("active");
  }
  </script>

  <!-- Supabase JS v2 CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

  <script>
  document.addEventListener('DOMContentLoaded', async () => {
      const SUPABASE_URL = "https://nwmjhnfkpuxkbdyfkynd.supabase.co";
      const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im53bWpobmZrcHV4a2JkeWZreW5kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2NDQzNzUsImV4cCI6MjA3NDIyMDM3NX0.iazrnqHbDSAQ6GxHJ2P9yqOm1rYTeBKOJ8E6XsZpZ2c";

      const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      const userList = document.getElementById("user-list");
      const form = document.getElementById("add-user-form");

      async function getUsers() {
          const { data, error } = await supabaseClient
              .from('users')
              .select('*')
              .order('id', { ascending: true });

          if (error) {
              console.error(error);
              return;
          }

          userList.innerHTML = '';
          data.forEach(user => {
              const li = document.createElement('li');
              li.textContent = `${user.vardas} ${user.pavarde}, kubatūra: ${user.kubatura}`;
              userList.appendChild(li);
          });
      }

      form.addEventListener('submit', async (e) => {
          e.preventDefault();
          const vardas = document.getElementById('vardas').value.trim();
          const pavarde = document.getElementById('pavarde').value.trim();
          const kubatura = document.getElementById('kubatura').value.trim();

          if (!vardas || !pavarde || !kubatura) {
              alert("Visi laukeliai privalomi!");
              return;
          }

          const { error } = await supabaseClient
              .from('users')
              .insert([{ vardas, pavarde, kubatura }]);

          if (error) {
              console.error(error);
              alert("Įvyko klaida!");
          } else {
              form.reset();
              getUsers();
          }
      });

     
  });
  </script>

</body>
</html>
